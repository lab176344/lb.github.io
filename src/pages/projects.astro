---
import Layout from '../layouts/Layout.astro';
import { getCollection, type CollectionEntry } from 'astro:content';

const projects = (await getCollection('projects')).sort(
	(a: CollectionEntry<'projects'>, b: CollectionEntry<'projects'>) => (a.data.order ?? 99) - (b.data.order ?? 99)
);
---

<Layout title="Projects">
	<h1 class="text-2xl font-bold text-tui-accent mb-6">~/projects</h1>

	<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
		{projects.map((project: CollectionEntry<'projects'>) => (
			<div class="border border-tui-border p-4 bg-tui-bg hover:border-tui-accent transition-colors group relative overflow-hidden">
				<div class="absolute top-0 right-0 bg-tui-border px-2 text-xs text-tui-dim group-hover:bg-tui-accent group-hover:text-tui-bg transition-colors">
					Project
				</div>
				
				<h3 class="text-xl font-bold text-tui-fg group-hover:text-tui-accent mb-2">
					{project.data.title}
				</h3>
				
				<p class="text-tui-dim mb-4 text-sm h-12 overflow-hidden">
					{project.data.description}
				</p>

				<div class="flex flex-wrap gap-2 mb-4">
					{project.data.techStack.map((tech: string) => (
						<span class="text-xs border border-tui-dim/50 px-1 rounded text-tui-dim">
							{tech}
						</span>
					))}
				</div>

				<div class="flex gap-4 text-sm">
					{project.data.repoUrl && (
						<a href={project.data.repoUrl} target="_blank" class="text-tui-accent hover:underline decoration-2">
							[ Source ]
						</a>
					)}
					{project.data.demoUrl && (
						<a href={project.data.demoUrl} target="_blank" class="text-tui-accent hover:underline decoration-2">
							[ Demo ]
						</a>
					)}
				</div>
			</div>
		))}
	</div>
</Layout>
